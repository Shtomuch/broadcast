{% extends 'users/base.html' %}
{% load static %}

{% block title %}Приєднатися до {{ meeting.title }}{% endblock %}

{% block extra_js %}
  <script>
    // домен разом із портом
    window.JITSI_DOMAIN = '{{ JITSI_DOMAIN }}';
  </script>

  <!-- 1) тягнемо скрипт по HTTP -->
  <script src="http://{{ JITSI_DOMAIN }}/external_api.js"></script>
  <!-- 2) ваш власний init -->
  <script src="{% static 'meetings/js/jitsi_init.js' %}"></script>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      initJitsiMeet(
        '{{ meeting.room_name }}',
        '#jitsi-container',
        {
          configOverwrite: {
            prejoinPageEnabled: false,
            enableWelcomePage: false,
            lobbyEnabled: false,
          },
          interfaceConfigOverwrite: {
            TOOLBAR_BUTTONS: [
              'microphone','camera','desktop','hangup',
              'chat','tileview','recording'
            ]
          },
          userInfo: { displayName: '{{ user.get_full_name }}' }
        }
      );
    });
  </script>
{% endblock %}

{% block content %}
  <div class="container">
    <h2>{{ meeting.title }}</h2>
    <p><strong>Заплановано на:</strong> {{ meeting.scheduled_time }}</p>
    <div id="jitsi-container" style="height:600px;"></div>
  </div>
{% endblock %}
